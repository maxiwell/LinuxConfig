#!/bin/bash

ignorelist="-path /home/max/ArchC -o 
            -path /home/max/.subversion -o 
            -path /home/max/.cache -o 
            -path /home/max/.local/share/Trash/files"

alldir=`find /home/max/ -type d \( $ignorelist \) -prune -o -print  | egrep -e "\.git$"`
home=$PWD

red='\033[0;31m'
yellow='\033[1;33m'
NC='\033[0m' # No Color

for k in $alldir; do
        dir=`echo $k | sed -e "s/\/\.git$//"`
        cd $dir
        if [ "$1" == "-f" ]; then
                git fetch &> /dev/null
        fi

        echo -ne "$dir (`git branch | cut -d\  -f2`) "
        STATUS=`git status`
        if [ `echo $STATUS | grep Untracked | wc -l` != 0 ]; then
            echo -ne "${red}untracked files ${NC}"
        fi
        if [ `echo $STATUS | grep behind | wc -l` != 0 ]; then
            echo -ne "${yellow}branch out-of-date ${NC}"
        fi


        echo -ne "\n"
done


